import re



# Search for rows that do not have timestamp as the last value or where site ID is missing
def get_row_numbers_to_delete(rtt_dataset):
    num_rows = len(rtt_dataset)
    drop_rows = []
    print("Rows to be dropped")
    for row in range(2000000, num_rows):  # Already established that the incorrect rows occur after approx 2M lines
        if not re.search("(\d+)-(\d+)-(\d+) (\d+):(\d+):(\d+)$", rtt_dataset[row]):
            print(rtt_dataset[row])
            drop_rows.append(row)
        if not re.search("^\d+,[a-zA-Z0-9-_]+,[a-zA-Z0-9-_]+,\d+.\d+", rtt_dataset[row]):
            print(rtt_dataset[row])
            drop_rows.append(row)

    print("Row indices = {}".format(drop_rows))
    return drop_rows

DATASET_LOCATION = "../datasets/large-imc21"
rtt_dataset = open(DATASET_LOCATION.rstrip("/") + "/SITE_RTT.csv").readlines()


#drop_rows = get_row_numbers_to_delete(rtt_dataset)
drop_rows = [213654373, 213654374, 213654375, 213654376, 213654377, 213654378, 213654379, 213654380, 213654381, 213654382, 213654383, 213654384, 213654385, 213654386, 213654387, 213654388, 213654389, 213654390, 213654391, 213654392, 213654393, 213654394, 213654395, 213654396, 213654397, 213654398, 213654399, 213654400, 213654401, 213654402, 213654403, 213654404, 213654405, 213654406, 213654407, 213654408, 213654409, 213654410, 213654411, 213654412, 213654413, 213654414, 213654415, 213654416, 213654417, 213654418, 213654419, 213654420, 213654421, 213654422, 213654423, 213654424, 213654425, 213654426, 213654427, 213654428, 213654429, 213654430, 213654431, 213654432, 213654432, 213654433, 213654434, 213654435, 213654436, 213654437, 213654438, 213654439, 213654440, 213654441, 213654442, 213654443, 213654444, 213654445, 213654446, 213654447, 213654448, 213654449, 213654450, 213654451, 213654452, 213654453, 213654454, 213654455, 213654456, 213654457, 213654458, 213654459, 213654460, 213654461, 213654462, 213654463, 213654464, 213654465, 213654466, 213654467, 213654468, 213654469, 213654470, 213654471, 213654472, 213654473, 213654474, 213654475, 213654476, 213654477, 213654478, 213654479, 213654480, 213654481, 213654482, 213654483, 213654484, 213654485, 213654486, 213654487, 213654488, 213654489, 213654490, 213654491, 213654492, 213654493, 213654494, 213654495, 213654496, 213654497, 213654498, 213654499, 213654500, 213654501, 213654502, 213654503, 213654504, 213654505, 213654506, 213654507, 213654508, 213654509, 213654510, 213654511, 213654512, 213654513, 213654514, 213654515, 213654516, 213654517, 213654518, 213654519, 213654520, 213654521, 213654522, 213654523, 213654524, 213654525, 213654526, 213654527, 213654528, 213654529, 213654530, 213654531, 213654532, 213654533, 213654534, 213654535, 213654536, 213654537, 213654538, 213654539, 213654540, 213654541, 213654542, 213654543, 213654544, 213654545, 213654546, 213654547, 213654548, 213654549, 213654550, 213654551, 213654552, 213654553, 213654554, 213654555, 213654556, 213654557, 213654558, 213654559, 213654560, 213654561, 213654562, 213654563, 213654564, 213654565, 213654566, 213654567, 213654568, 213654569, 213654570, 213654571, 213654572, 213654573, 213654574, 213654575, 213654576, 213654577, 213654578, 213654579, 213654580, 213654581, 213654582, 213654583, 213654584, 213654585, 213654586, 213654587, 213654588, 213654589, 213654590, 213654591, 213654592, 213654593, 213654594, 213654595, 213654596, 213654597, 213654598, 213654599, 213654600, 213654601, 213654602, 213654603, 213654604, 213654605, 213654606, 213654607, 213654608, 213654609, 213654610, 213654611, 213654612, 213654613, 213654614, 213654615, 213654616, 213654617, 213654618, 213654619, 213654620, 213654621, 213654622, 213654623, 213654624, 213654625, 213654626, 213654627, 213654628, 213654629, 213654630, 213654631, 213654632, 213654633, 213654634, 213654635, 213654636, 213654637, 213654638, 213654639, 213654640, 213654641, 213654642, 213654643, 213654644, 213654645, 213654646, 213654647, 213654648, 213654649, 213654650, 213654651, 213654652, 213654653, 213654654, 213654655, 213654656, 213654657, 213654658, 213654659, 213654660, 213654661, 213654662, 213654663, 213654664, 213654665, 213654666, 213654667, 213654668, 213654669, 213654670, 213654671, 213654672, 213654673, 213654674, 213654675, 213654676, 213654677, 213654678, 213654679, 213654680, 213654681, 213654682, 213654683, 213654684, 213654685, 213654686, 213654687, 213654688, 213654689, 213654690, 213654691, 213654692, 213654693, 213654694, 213654695, 213654696, 213654697, 213654698, 213654699, 213654700, 213654701, 213654702, 213654703, 213654704, 213654705, 213654706, 213654707, 213654708, 213654709, 213654710, 213654711, 213654712, 213654713, 213654714, 213654715, 213654716, 213654717, 213654718, 213654719, 213654720, 213654721, 213654722, 213654723, 213654724, 213654725, 213654726, 213654727, 213654728, 213654729, 213654730, 213654731, 213654732, 213654733, 213654734, 213654735, 213654736, 213654737, 213654738, 213654739, 213654740, 213654741, 213654742, 213654743, 213654744, 213654745, 213654746, 213654747, 213654748, 213654749, 213654750, 213654751, 213654752, 213654753, 213654754, 213654755, 213654756, 213654757, 213654758, 213654759, 213654760, 213654761, 213654762, 213654763, 213654764, 213654765, 213654766, 213654767, 213654768, 213654769, 213654770, 213654771, 213654772, 213654773, 213654774, 213654775, 213654776, 213654777, 213654778, 213654779, 213654780, 213654781, 213654782, 213654783, 213654784, 213654785, 213654786, 213654787, 213654788, 213654789, 213654790, 213654791, 213654792, 213654793, 213654794, 213654795, 213654796, 213654797, 213654798, 213654799, 213654800, 213654801, 213654802, 213654803, 213654804, 213654805, 213654806, 213654807, 213654808, 213654809, 213654810, 213654811, 213654812, 213654813, 213654814, 213654815, 213654816, 213654817, 213654818, 213654819, 213654820, 213654821, 213654822, 213654823, 213654824, 213654825, 213654826, 213654827, 213654828, 213654829, 213654830, 213654831, 213654832, 213654833, 213654834, 213654835, 213654836, 213654837, 213654838, 213654839, 213654840, 213654841, 213654842, 213654843, 213654844, 213654845, 213654846, 213654847, 213654848, 213654849, 213654850, 213654851, 213654852, 213654853, 213654854, 213654855, 213654856, 213654857, 213654858, 213654859, 213654860, 213654861, 213654862, 213654863, 213654864, 213654865, 213654866, 213654867, 213654868, 213654869, 213654870, 213654871, 213654872, 213654873, 213654874, 213654875, 213654876, 213654877, 213654878, 213654879, 213654880, 213654881, 213654882, 213654883, 213654884, 213654885, 213654886, 213654887, 213654888, 213654889, 213654890, 213654891, 213654892, 213654893, 213654894, 213654895, 213654896, 213654897, 213654898, 213654899, 213654900, 213654901, 213654902, 213654903, 213654904, 213654905, 213654906, 213654907, 213654908, 213654909, 213654910, 213654911, 213654912, 213654913, 213654914, 213654915, 213654916, 213654917, 213654918, 213654919, 213654920, 213654921, 213654922, 213654923, 213654924, 213654925, 213654926, 213654927, 213654928, 213654929, 213654930, 213654931, 213654932, 213654933, 213654934, 213654935, 213654936, 213654937, 213654938, 213654939, 213654940, 213654941, 213654942, 213654943, 213654944, 213654945, 213654946, 213654947, 213654948, 213654949, 213654950, 213654951, 213654952, 213654953, 213654954, 213654955, 213654956, 213654957, 213654958, 213654959, 213654960, 213654961, 213654962, 213654963, 213654964, 213654965, 213654966, 213654967, 213654968, 213654969, 213654970, 213654971, 213654972, 213654973, 213654974, 213654975, 213654976, 213654977, 213654978, 213654979, 213654980, 213654981, 213654982, 213654983, 213654984, 213654985, 213654986, 213654987, 213654988, 213654989, 213654990, 213654991, 213654992, 213654993, 213654994, 213654995, 213654996, 213654997, 213654998, 213654999, 213655000, 213655001, 213655002, 213655003, 213655004, 213655005, 213655006, 213655007, 213655008, 213655009, 213655010, 213655011, 213655012, 213655013, 213655014, 213655015, 213655016, 213655017, 213655018, 213655019, 213655020, 213655021, 213655022, 213655023, 213655024, 213655025, 213655026, 213655027, 213655028, 213655029, 213655030, 213655031, 213655032, 213655033, 213655034, 213655035, 213655036, 213655037, 213655038, 213655039, 213655040, 213655041, 213655042, 213655043, 213655044, 213655045, 213655046, 213655047, 213655048, 213655049, 213655050, 213655051, 213655052, 213655053, 213655054, 213655055, 213655056, 213655057, 213655058, 213655059, 213655060, 213655061, 213655062, 213655063, 213655064, 213655065, 213655066, 213655067, 213655068, 213655069, 213655070, 213655071, 213655072, 213655073, 213655074, 213655075, 213655076, 213655077, 213655078, 213655079, 213655080, 213655081, 213655082, 213655083, 213655084, 213655085, 213655086, 213655087, 213655088, 213655089, 213655090, 213655091, 213655092, 213655093, 213655094, 213655095, 213655096, 213655097, 213655098, 213655099, 213655100, 213655101, 213655102, 213655103, 213655104, 213655105, 213655106, 213655107, 213655108, 213655109, 213655110, 213655111, 213655112, 213655113, 213655114, 213655115, 213655116, 213655117, 213655118, 213655119, 213655120, 213655121, 213655122, 213655123, 213655124, 213655125, 213655126, 213655127, 213655128, 213655129, 213655130, 213655131, 213655132, 213655133, 213655134, 213655135, 213655136, 213655137, 213655138, 213655139, 213655140, 213655141, 213655142, 213655143, 213655144, 213655145, 213655146, 213655147, 213655148, 213655149, 213655150, 213655151, 213655152, 213655153, 213655154, 213655155, 213655156, 213655157, 213655158, 213655159, 213655160, 213655161, 213655162, 213655163, 213655164, 213655165, 213655166, 213655167, 213655168, 213655169, 213655170, 213655171, 213655172, 213655173, 213655174, 213655175, 213655176, 213655177, 213655178, 213655179, 213655180, 213655181, 213655182, 213655183, 213655184, 213655185, 213655186, 213655187, 213655188, 213655189, 213655190, 213655191, 213655192, 213655193, 213655194, 213655195, 213655196, 213655197, 213655198, 213655199, 213655200, 213655201, 213655202, 213655203, 213655204, 213655205, 213655206, 213655207, 213655208, 213655209, 213655210, 213655211, 213655212, 213655213, 213655214, 213655215, 213655216, 213655217, 213655218, 213655219, 213655220, 213655221, 213655222, 213655223, 213655224, 213655225, 213655226, 213655227, 213655228, 213655229, 213655230, 213655231, 213655232, 213655233, 213655234, 213655235, 213655236, 213655237, 213655238, 213655239, 213655240, 213655241, 213655242, 213655243, 213655244, 213655245, 213655246, 213655247, 213655248, 213655249, 213655250, 213655251, 213655252, 213655253, 213655254, 213655255, 213655256, 213655257, 213655258, 213655259, 213655260, 213655261, 213655262, 213655263, 213655264, 213655265, 213655266, 213655267, 213655268, 213655269, 213655270, 213655271, 213655272, 213655273, 213655274, 213655275, 213655276, 213655277, 213655278, 213655279, 213655280, 213655281, 213655282, 213655283, 213655284, 213655285, 213655286, 213655287, 213655288, 213655289, 213655290, 213655291, 213655292, 213655293, 213655294, 213655295, 213655296, 213655297, 213655298, 213655299, 213655300, 213655301, 213655302, 213655303, 213655304, 213655305, 213655306, 213655307, 213655308, 213655309, 213655310, 213655311, 213655312, 213655313, 213655314, 213655315, 213655316, 213655317, 213655318, 213655319, 213655320, 213655321, 213655322, 213655323, 213655324, 213655325, 213655326, 213655327, 213655328, 213655329, 213655330, 213655331, 213655332, 213655333, 213655334, 213655335, 213655336, 213655337, 213655338, 213655339, 213655340, 213655341, 213655342, 213655343, 213655344, 213655345, 213655346, 213655347, 213655348, 213655349, 213655350, 213655351, 213655352, 213655353, 213655354, 213655355, 213655356, 213655357, 213655358, 213655359, 213655360, 213655361, 213655362, 213655363, 213655364, 213655365, 213655366, 213655367, 213655368, 213655369, 213655370, 213655371, 213655372, 213655373, 213655374, 213655375, 213655376, 213655377, 213655378, 213655379, 213655380, 213655381, 213655382, 213655383, 213655384, 213655385, 213655386, 213655387, 213655388, 213655389, 213655390, 213655391, 213655392, 213655393, 213655394, 213655395, 213655396, 213655397, 213655398, 213655399, 213655400, 213655401, 213655402, 213655403, 213655404, 213655405, 213655406, 213655407, 213655408, 213655409, 213655410, 213655411, 213655412, 213655413, 213655414, 213655415, 213655416, 213655417, 213655418, 213655419, 213655420, 213655421, 213655422, 213655423, 213655424, 213655425, 213655426, 213655427, 213655428, 213655429, 213655430, 213655431, 213655432, 213655433, 213655434, 213655435, 213655436, 213655437, 213655438, 213655439, 213655440, 213655441, 213655442, 213655443, 213655444, 213655445, 213655446, 213655447, 213655448, 213655449, 213655450, 213655451, 213655452, 213655453, 213655454, 213655455, 213655456, 213655457, 213655458, 213655459, 213655460, 213655461, 213655462, 213655463, 213655464, 213655465, 213655466, 213655467, 213655468, 213655469, 213655470, 213655471, 213655472, 213655473, 213655474, 213655475, 213655476, 213655477, 213655478, 213655479, 213655480, 213655481, 213655482, 213655483, 213655484, 213655485, 213655486, 213655487, 213655488, 213655489, 213655490, 213655491, 213655492, 213655493, 213655494, 213655495, 213655496, 213655497, 213655498, 213655499, 213655500, 213655501, 213655502, 213655503, 213655504, 213655505, 213655506, 213655507, 213655508, 213655509, 213655510, 213655511, 213655512, 213655513, 213655514, 213655515, 213655516, 213655517, 213655518, 213655519, 213655520, 213655521, 213655522, 213655523, 213655524, 213655525, 213655526, 213655527, 213655528, 213655529, 213655530, 213655531, 213655532, 213655533, 213655534, 213655535, 213655536, 213655537, 213655538, 213655539, 213655540, 213655541, 213655542, 213655543, 213655544, 213655545, 213655546, 213655547, 213655548, 213655549, 213655550, 213655551, 213655552, 213655553, 213655554, 213655555, 213655556, 213655557, 213655558, 213655559, 213655560, 213655561, 213655562, 213655563, 213655564, 213655565, 213655566, 213655567, 213655568, 213655569, 213655570, 213655571, 213655572, 213655573, 213655574, 213655575, 213655576, 213655577, 213655578, 213655579, 213655580, 213655581, 213655582, 213655583, 213655584, 213655585, 213655586, 213655587, 213655588, 213655589, 213655590, 213655591, 213655592, 213655593, 213655594, 213655595, 213655596, 213655597, 213655598, 213655599, 213655600, 213655601, 213655602, 213655603, 213655604, 213655605, 213655606, 213655607, 213655608, 213655609, 213655610, 213655611, 213655612, 213655613, 213655614, 213655615, 213655616, 213655617, 213655618, 213655619, 213655620, 213655621, 213655622, 213655623, 213655624, 213655625, 213655626, 213655627, 213655628, 213655629, 213655630, 213655631, 213655632, 213655633, 213655634, 213655635, 213655636, 213655637, 213655638, 213655639, 213655640, 213655641, 213655642, 213655643, 213655644, 213655645, 213655646, 213655647, 213655648, 213655649, 213655650, 213655651, 213655652, 213655653, 213655654, 213655655, 213655656, 213655657, 213655658, 213655659, 213655660, 213655661, 213655662, 213655663, 213655664, 213655665, 213655666, 213655667, 213655668, 213655669, 213655670, 213655671, 213655672, 213655673, 213655674, 213655675, 213655676, 213655677, 213655678, 213655679, 213655680, 213655681, 213655682, 213655683, 213655684, 213655685, 213655686, 213655687, 213655688, 213655689, 213655690, 213655691, 213655692, 213655693, 213655694, 213655695, 213655696, 213655697, 213655698, 213655699, 213655700, 213655701, 213655702, 213655703, 213655704, 213655705, 213655706, 213655707, 213655708, 213655709, 213655710, 213655711, 213655712, 213655713, 213655714, 213655715, 213655716, 213655717, 213655718, 213655719, 213655720, 213655721, 213655722, 213655723, 213655724, 213655725, 213655726, 213655727, 213655728, 213655729, 213655730, 213655731, 213655732, 213655733, 213655734, 213655735, 213655736, 213655737, 213655738, 213655739, 213655740, 213655741, 213655742, 213655743, 213655744, 213655745, 213655746, 213655747, 213655748, 213655749, 213655750, 213655751, 213655752, 213655753, 213655754, 213655755, 213655756, 213655757, 213655758, 213655759, 213655760, 213655761, 213655762, 213655763, 213655764, 213655765, 213655766, 213655767, 213655767, 213655768, 213655768, 213655769, 213655769, 213655770, 213655770, 213655771, 213655771, 213655772, 213655772, 213655773, 213655773, 213655774, 213655774, 213655775, 213655775, 213655776, 213655776, 213655777, 213655777, 213655778, 213655778, 213655779, 213655779, 213655780, 213655780, 213655781, 213655781, 213655782, 213655782, 213655783, 213655783, 213655784, 213655784, 213655785, 213655785, 213655786, 213655786, 213655787, 213655787, 213655788, 213655788, 213655789, 213655789, 213655790, 213655791, 213655791, 213655792, 213655792, 213655793, 213655793, 213655794, 213655794, 213655795, 213655795, 213655796, 213655796, 213655797, 213655797, 213655798, 213655798, 213655799, 213655799, 213655800, 213655800, 213655801, 213655801, 213655802, 213655802, 213655803, 213655803, 213655804, 213655804, 213655805, 213655805, 213655806, 213655806, 213655807, 213655807, 213655808, 213655808, 213655809, 213655809, 213655810, 213655810, 213655811, 213655811, 213655812, 213655812, 213655813, 213655813, 213655814, 213655815, 213655816, 213655816, 213655817, 213655817, 213655818, 213655818, 213655819, 213655819, 213655820, 213655820, 213655821, 213655821, 213655822, 213655822, 213655823, 213655823, 213655824, 213655824, 213655825, 213655825, 213655826, 213655826, 213655827, 213655827, 213655828, 213655828, 213655829, 213655829, 213655830, 213655830, 213655831, 213655831, 213655832, 213655832, 213655833, 213655833, 213655834, 213655834, 213655835, 213655835, 213655836, 213655836, 213655837, 213655837, 213655838, 213655838, 213655839, 213655839, 213655840, 213655840, 213655841, 213655841, 213655842, 213655842, 213655843, 213655843, 213655844, 213655844, 213655845, 213655845, 213655846, 213655846, 213655847, 213655847, 213655848, 213655848, 213655849, 213655849, 213655850, 213655850, 213655851, 213655851, 213655852, 213655852, 213655853, 213655853, 213655854, 213655854, 213655855, 213655855, 213655856, 213655856, 213655857, 213655857, 213655858, 213655858, 213655859, 213655859, 213655860, 213655860, 213655861, 213655861, 213655862, 213655862, 213655863, 213655863, 213655864, 213655864, 213655865, 213655865, 213655866, 213655866, 213655867, 213655867, 213655868, 213655868, 213655869, 213655869, 213655870, 213655870, 213655871, 213655871, 213655872, 213655872, 213655873, 213655873, 213655874, 213655874, 213655875, 213655875, 213655876, 213655876, 213655877, 213655877, 213655878, 213655878, 213655879, 213655879, 213655880, 213655880, 213655881, 213655881, 213655882, 213655882, 213655883, 213655883, 213655884, 213655884, 213655885, 213655885, 213655886, 213655886, 213655887, 213655887, 213655888, 213655888, 213655889, 213655889, 213655890, 213655890, 213655891, 213655891, 213655892, 213655892, 213655893, 213655893, 213655894, 213655894, 213655895, 213655895, 213655896, 213655896, 213655897, 213655897, 213655898, 213655898, 213655899, 213655899, 213655900, 213655900, 213655901, 213655901, 213655902, 213655902, 213655903, 213655903, 213655904, 213655904, 213655905, 213655905, 213655906, 213655906, 213655907, 213655907, 213655908, 213655908, 213655909, 213655909, 213655910, 213655910, 213655911, 213655911, 213655912, 213655912, 213655913, 213655913, 213655914, 213655914, 213655915, 213655915, 213655916, 213655916, 213655917, 213655917, 213655918, 213655918, 213655919, 213655919, 213655920, 213655920, 213655921, 213655921, 213655922, 213655922, 213655923, 213655923, 213655924, 213655924, 213655925, 213655925, 213655926, 213655926, 213655927, 213655927, 213655928, 213655928, 213655929, 213655929, 213655930, 213655930, 213655931, 213655931, 213655932, 213655932, 213655933, 213655933, 213655934, 213655934, 213655935, 213655935, 213655936, 213655936, 213655937, 213655937, 213655938, 213655938, 213655939, 213655939, 213655940, 213655940, 213655941, 213655941, 213655942, 213655942, 213655943, 213655943, 213655944, 213655944, 213655945, 213655945, 213655946, 213655946, 213655947, 213655947, 213655948, 213655948, 213655949, 213655949, 213655950, 213655950, 213655951, 213655951, 213655952, 213655952, 213655953, 213655953, 213655954, 213655954, 213655955, 213655955, 213655956, 213655956, 213655957, 213655957, 213655958, 213655958, 213655959, 213655959, 213655960, 213655960, 213655961, 213655961, 213655962, 213655962, 213655963, 213655963, 213655964, 213655964, 213655965, 213655966, 213655966, 213655967, 213655967, 213655968, 213655968, 213655969, 213655969, 213655970, 213655970, 213655971, 213655971, 213655972, 213655972, 213655973, 213655973, 213655974, 213655974, 213655975, 213655975, 213655976, 213655976, 213655977, 213655977]
drop_rows = set(drop_rows)
print("Number of rows to be removed = {}".format(len(drop_rows)))
clean_lines_list = [i for j, i in enumerate(rtt_dataset) if j not in drop_rows]

if len(clean_lines_list) + len(drop_rows) != len(rtt_dataset):
    print("ERROR. Total number of lines do not match after deleting lines")
    print(len(clean_lines_list), len(drop_rows), len(rtt_dataset))

file_out = open(DATASET_LOCATION.rstrip("/") + "/SITE_RTT_clean.csv", "w")
for line in clean_lines_list:
    file_out.write(line)
file_out.close()
print("Finished writing")
